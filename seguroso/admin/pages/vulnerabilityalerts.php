<div class="wrap">
	<h1><?php _e( 'Vulnerability Alerts', G2_Vulnerability_Alerts::$id ) ?></h1>
	<form method='post'>
		<input type="hidden" name="verify" value="1">
		<input type="hidden" name="action" value="g2_report_check_now" id="">
		<p class="alignright"><?php submit_button( __( 'Check Now', G2_Vulnerability_Alerts::$id ), 'primary', 'submit', FALSE ) ?></p>
		<p><?php printf( __( 'Last request to %s on %s', G2_Vulnerability_Alerts::$id ), '<a href="https://wpvulndb.com/" target="_blank">WPScan Vulnerability Database</a>', date_i18n( get_option( 'date_format' ) . ' ' . get_option( 'time_format' ), get_option( 'g2_report_last_check' ) ) ); ?>
			<br>
			<?php _e( 'Some paid plugins and themes, or developed exclusively for this website and not shared for the public, may not be reported on WPScan.', G2_Vulnerability_Alerts::$id ) ?>
		</p>
	</form>
	<h3>WordPress</h3>
	<table class="wp-list-table widefat striped plugins">
		<thead>
		<tr>
			<td scope="col" class="manage-column check-column">&nbsp;</td>
			<th scope="col" class="manage-column column-name column-primary" width="250"><?php _e( 'Name', G2_Vulnerability_Alerts::$id ) ?></th>
			<th scope="col" class="manage-column column-description"><?php _e( 'Vulnerabilities', G2_Vulnerability_Alerts::$id ) ?></th>
		</tr>
		</thead>
		<tbody id="report-wordpress">
		<tr>
			<th scope="row" class="check-column" align="center"><?php echo G2_Vulnerability_Alerts::get_status( 'wordpress' ) ?></span></th>
			<td class="plugin-title column-primary"><strong>WordPress</strong> <?php echo sprintf( __( 'Version %s', G2_Vulnerability_Alerts::$id ), get_bloginfo( 'version' ) ) ?></td>
			<td><?php G2_Vulnerability_Alerts::list_vulnerabilities( 'wordpress' ) ?></td>
		</tr>
		</tbody>
	</table>
	<h3><?php _e( 'Plugins', G2_Vulnerability_Alerts::$id ) ?></h3>
	<table class="wp-list-table widefat striped plugins">
		<thead>
		<tr>
			<td scope="col" class="manage-column check-column">&nbsp;</td>
			<th scope="col" class="manage-column column-name column-primary" width="250"><?php _e( 'Name', G2_Vulnerability_Alerts::$id ) ?></th>
			<th scope="col" class="manage-column column-description"><?php _e( 'Vulnerabilities', G2_Vulnerability_Alerts::$id ) ?></th>
		</tr>
		</thead>
		<tbody id="report-plugins">
		<?php foreach ( get_plugins() as $name => $details ) : ?>
			<tr>
				<th scope="row" class="check-column" align="center"><?php echo G2_Vulnerability_Alerts::get_status( 'plugins', $name ) ?></span></th>
				<td class="plugin-title column-primary"><strong><?php echo $details['Name'] ?></strong> <?php echo sprintf( __( 'Version %s', G2_Vulnerability_Alerts::$id ), $details['Version'] ) ?>
				</td>
				<td><?php G2_Vulnerability_Alerts::list_vulnerabilities( 'plugins', $name ) ?></td>
			</tr>
		<?php endforeach; ?>
		</tbody>
	</table>
	<h3><?php _e( 'Themes', G2_Vulnerability_Alerts::$id ) ?></h3>
	<table class="wp-list-table widefat striped plugins">
		<thead>
		<tr>
			<td scope="col" class="manage-column check-column">&nbsp;</td>
			<th scope="col" class="manage-column column-name column-primary" width="250"><?php _e( 'Name', G2_Vulnerability_Alerts::$id ) ?></th>
			<th scope="col" class="manage-column column-description"><?php _e( 'Vulnerabilities', G2_Vulnerability_Alerts::$id ) ?></th>
		</tr>
		</thead>
		<tbody id="report-themes">
		<?php foreach ( wp_get_themes() as $name => $details ) : ?>
			<tr>
				<th scope="row" class="check-column" align="center"><?php echo G2_Vulnerability_Alerts::get_status( 'themes', $name ) ?></span></th>
				<td class="plugin-title column-primary"><strong><?php echo $details['Name'] ?></strong> <?php echo sprintf( __( 'Version %s', G2_Vulnerability_Alerts::$id ), $details['Version'] ) ?>
				</td>
				<td><?php G2_Vulnerability_Alerts::list_vulnerabilities( 'themes', $name ) ?></td>
			</tr>
		<?php endforeach; ?>
		</tbody>
	</table>
</div>
